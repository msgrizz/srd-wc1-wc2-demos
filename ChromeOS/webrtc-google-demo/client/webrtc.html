<!DOCTYPE html>
<html>
    <head>
    <title>WebRTC test</title>
     <link rel="stylesheet" href="css/main.css">
    </head>
    <body>
        <div class="applicationContainer">
        <div id="connectBar">
            <span>
            <img src="img/Voyager_Legend_C_print_Morini5.png" />
            <span class="name">PLTLabs WebRTC Integration</span>
            <input type="button" id="butConnect" value="Connect"/>
            </span>
        </div>
        <div id="video-container">
            <video id="remote-video" autoplay></video>
            <video id="local-video" muted="true" autoplay></video>
        </div>
        </div>
      <script src="js/vendor/jquery-1.10.2.min.js"></script> 
      <script src="js/vendor/peer.js"></script>
      <script src="js/pltlabs-device-access.js"></script>
      <script>
        var messageHandler = function(e) {
            console.log('Background script says hello.', e.data);
        };

        window.addEventListener('message', messageHandler);
        
        var peer = null;

        // Compatibility shim
        navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;
        
         
        // PeerJS object
        peer = new Peer('Cary', {host:'localhost', port: 9000, debug: 3, config: {'iceServers': [{ url: 'stun:stun.l.google.com:19302' } ]}});
    
        peer.on('open', function(){
         //    $('#my-id').text(peer.id);
        });
        
        gum();
        
        function gum () {
            // Get audio/video stream
            navigator.getUserMedia({audio: true, video: true},
                                   function(stream){
                                    // Set your video displays
                                    $('#local-video').prop('src', URL.createObjectURL(stream));
                                    window.localStream = stream;
                                    //todo - put placeholder in here
                                    },
                                    function(){ $('#step1-error').show(); });
}
      </script>
    </body>
</html>